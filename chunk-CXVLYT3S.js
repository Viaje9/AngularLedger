import{a as x,b as w,c as pe,d as te,e as Re,i as me,j as ue,k as ge,t as fe}from"./chunk-73HW63VR.js";import{Aa as o,Ba as s,Ca as m,Cb as le,Da as _,Ga as p,Ia as g,M as A,Na as E,O as M,Oa as k,Pa as b,Qa as Z,Qc as N,Ra as l,S as f,Sa as R,T as h,Ta as y,Tc as Q,Va as O,Wa as ee,Xa as B,Ya as L,Yc as q,Za as ae,bd as U,cd as de,d as ke,e as K,eb as Y,ga as d,gd as W,ha as u,ib as se,ja as be,jb as Ae,k as ne,nb as P,o as re,ob as Me,pa as T,pb as I,qb as ce,ra as v,sa as oe,tb as $,va as F,x as G,xa as X,ya as S,za as D}from"./chunk-Q25J75AG.js";var Oe=(()=>{let e=class e{ngOnInit(){}};e.\u0275fac=function(a){return new(a||e)},e.\u0275cmp=M({type:e,selectors:[["app-ledger"]],standalone:!0,features:[O],decls:1,vars:0,template:function(a,n){a&1&&m(0,"router-outlet")},dependencies:[Ae,Me],styles:["[_nghost-%COMP%]{display:block}"]});let r=e;return r})();var C=function(r){return r.Add="add",r.Edit="edit",r}(C||{});var Ye=["scrollTags"],Pe=["tagGroup"],$e=["templateRef"],Ne=["priceInput"],Qe=["descriptionInput"];function qe(r,e){if(r&1){let i=_();o(0,"button",20),p("click",function(){f(i);let a=g();return h(a.onClickSave())}),l(1," \u5132\u5B58 "),s()}}function Ue(r,e){if(r&1){let i=_();o(0,"button",20),p("click",function(){f(i);let a=g();return h(a.onClickEdit())}),l(1," \u5132\u5B58 "),s()}}var We=(r,e)=>e.id,Je=r=>({"bg-neutral-300":r});function ze(r,e){if(r&1){let i=_();o(0,"div",24),p("click",function(){let n=f(i).$implicit,c=g(2);return h(c.onTagClick(n.id))}),m(1,"i",25),o(2,"p"),l(3),s()()}if(r&2){let i=e.$implicit,t=g(2);v("ngClass",ee(3,Je,i.id===t.selectedTagId)),d(),v("ngClass",i.tagIconName),d(2),R(i.tagName)}}function He(r,e){if(r&1&&(o(0,"div",21,22)(2,"div",23),S(3,ze,4,5,"div",26,We),s()()),r&2){let i=e.$implicit;d(3),D(i)}}var Ke=r=>({"bg-gray-900":r});function Xe(r,e){if(r&1&&m(0,"div",27),r&2){let i=e.$index,t=g();v("ngClass",ee(1,Ke,t.currentTagGroupPage===i))}}function Ze(r,e){if(r&1){let i=_();o(0,"div",28),p("click",function(){f(i);let a=g();return h(a.onClickDelete())}),m(1,"i",29),o(2,"p",30),l(3,"\u522A\u9664"),s()()}}function et(r,e){if(r&1){let i=_();o(0,"textarea",31,32),p("ngModelChange",function(a){f(i);let n=g();return h(n.description=a)}),s()}if(r&2){let i=g();v("ngModel",i.description)}}var Be=(()=>{let e=class e{get StatusEnum(){return C}constructor(t,a,n,c,j,H){if(this.route=t,this.router=a,this.modalService=n,this.loaderService=c,this.ledgerService=j,this.changeDetectorRef=H,this.maxTagGroupPage=0,this.currentTagGroupPage=0,this.translateFactor="translate(0, 0)",this.tagsGroup=[],this.selectedTagId="",this.description="",this.tagsGroup=this.route.snapshot.data.tagListGroup,this.expenseStatus=this.route.snapshot.data.data.expenseStatus,this.expenseStatus===C.Edit){let ie=this.route.snapshot.data.data;this.price=parseInt(ie.price),this.selectedTagId=ie.tagId,this.description=ie.description,this.date=ie.date}else this.expenseStatus===C.Add&&(this.date=this.route.snapshot.data.data.date)}ngOnInit(){}ngAfterViewInit(){let t=this.scrollTagsRef.nativeElement.scrollWidth,a=this.tagGroupRef.nativeElement.scrollWidth;this.maxTagGroupPage=Math.ceil(t/a)}onSwipeRight(){if(this.currentTagGroupPage>0){this.currentTagGroupPage-=1;let t=this.currentTagGroupPage*100;this.translateFactor=`translate(-${t}%, 0)`}}onSwipeLeft(){if(this.currentTagGroupPage<this.maxTagGroupPage-1){this.currentTagGroupPage+=1;let t=this.currentTagGroupPage*100;this.translateFactor=`translate(-${t}%, 0)`}}onTagClick(t){this.selectedTagId===t?this.selectedTagId="":(this.priceInput.nativeElement.focus(),this.selectedTagId=t)}onClickBack(){this.router.navigateByUrl("/",{state:{transactionType:x.Expense,date:this.date.toDate()}})}onClickSave(){return K(this,null,function*(){this.saveCheck()&&(this.loaderService.start(),yield this.ledgerService.addExpense({date:this.date,price:this.price.toString(),tagId:this.selectedTagId,description:this.description}).catch(t=>{console.error("Error adding document: ",t)}).then(()=>{this.router.navigateByUrl("/",{state:{transactionType:x.Expense,date:this.date.toDate()}})}).finally(()=>this.loaderService.stop()))})}onClickEdit(){return K(this,null,function*(){this.saveCheck()&&(this.loaderService.start(),yield this.ledgerService.updateExpense({docId:this.route.snapshot.data.data.docId,date:this.date,price:this.price.toString(),tagId:this.selectedTagId,description:this.description}).catch(t=>{console.error("Error updating document: ",t)}).then(()=>{this.router.navigateByUrl("/",{state:{transactionType:x.Expense,date:this.date.toDate()}})}).finally(()=>this.loaderService.stop()))})}saveCheck(){let t=this.tagsGroup.some(a=>a.some(n=>n.id===this.selectedTagId));return!this.selectedTagId||!this.price||!t?(this.modalService.openConfirm({content:"\u8ACB\u8F38\u5165\u91D1\u984D\u8207\u9078\u64C7\u6A19\u7C64",okText:"\u78BA\u8A8D",showCancelBtn:!1,outsideClose:!0}),!1):!0}onClickDescription(){this.modalService.openConfirm({title:"\u5099\u8A3B",okText:"\u78BA\u8A8D",showCancelBtn:!1,outsideClose:!0,contentTemplateRef:this.templateRef,afterViewInit:()=>{this.changeDetectorRef.detectChanges(),this.descriptionInput?.nativeElement.focus()}})}onClickDelete(){this.modalService.openConfirm({content:"\u78BA\u8A8D\u522A\u9664\uFF1F",outsideClose:!0,onOk:()=>{this.doDelete()}})}doDelete(){this.loaderService.start(),this.ledgerService.deleteExpense(this.route.snapshot.data.data.docId).then(()=>{this.router.navigateByUrl("/",{state:{transactionType:x.Expense,date:this.date.toDate()}})}).finally(()=>this.loaderService.stop())}};e.\u0275fac=function(a){return new(a||e)(u(P),u(I),u(N),u($),u(w),u(be))},e.\u0275cmp=M({type:e,selectors:[["app-add-expense"]],viewQuery:function(a,n){if(a&1&&(E(Ye,5),E(Pe,5),E($e,5),E(Ne,5),E(Qe,5)),a&2){let c;k(c=b())&&(n.scrollTagsRef=c.first),k(c=b())&&(n.tagGroupRef=c.first),k(c=b())&&(n.templateRef=c.first),k(c=b())&&(n.priceInput=c.first),k(c=b())&&(n.descriptionInput=c.first)}},standalone:!0,features:[O],decls:31,vars:6,consts:[[1,"bg-gray-800","text-white","p-4","flex","justify-between","items-center"],[1,"w-10",3,"click"],[1,"fas","fa-arrow-left"],[1,"text-lg"],["class","bg-gray-600 px-4 py-2 rounded"],[1,"bg-red-600","text-center","p-10","flex"],[1,"text-white","text-3xl","me-3","pt-2"],["autocomplete","off","id","tagName","type","number","inputmode","numeric",1,"w-full","text-right","bg-red-600","rounded","border","border-red-700","focus:border-red-500","focus:ring-2","focus:ring-red-900","text-3xl","outline-none","text-gray-100","py-1","px-3","leading-8","transition-colors","duration-200","ease-in-out",3,"ngModel","ngModelChange"],["priceInput",""],[1,"w-full","overflow-hidden"],[1,"flex","w-full","transition",3,"swipeLeft","swipeRight"],["scrollTags",""],[1,"flex","justify-center","my-4"],[1,"bg-white","py-4","border-t","border-gray-300"],[1,"flex","p-4","border-b","items-center","justify-between",3,"click"],[1,"flex","items-center"],[1,"mr-4","fas","fa-pencil-alt"],[1,"w-3/5","text-ellipsis","overflow-hidden","text-right","text-nowrap"],["class","flex p-4 border-b justify-center items-center bg-red-600 text-white text-2xl"],["templateRef",""],[1,"bg-gray-600","px-4","py-2","rounded",3,"click"],[1,"w-screen","text-center"],["tagGroup",""],[1,"flex","w-screen","flex-wrap"],[1,"w-1/3","py-8",3,"ngClass","click"],[3,"ngClass"],["class","w-1/3 py-8",3,"ngClass"],[1,"mx-2","w-2","h-2","bg-gray-500","rounded-full",3,"ngClass"],[1,"flex","p-4","border-b","justify-center","items-center","bg-red-600","text-white","text-2xl",3,"click"],[1,"fas","fa-trash","mr-2"],[1,""],["rows","10",1,"text-black","w-full","py-1","px-2","focus:border-none","focus:outline-none",3,"ngModel","ngModelChange"],["descriptionInput",""],["class","w-screen text-center"],["class","mx-2 w-2 h-2 bg-gray-500 rounded-full",3,"ngClass"]],template:function(a,n){a&1&&(o(0,"div",0)(1,"div",1),p("click",function(){return n.onClickBack()}),m(2,"i",2),s(),o(3,"h1",3),l(4,"\u65B0\u589E\u652F\u51FA"),s(),T(5,qe,2,0,"button",4)(6,Ue,2,0),s(),o(7,"div",5)(8,"span",6),l(9,"$"),s(),o(10,"input",7,8),p("ngModelChange",function(j){return n.price=j}),s()(),o(12,"div",9)(13,"div",10,11),p("swipeLeft",function(){return n.onSwipeLeft()})("swipeRight",function(){return n.onSwipeRight()}),S(15,He,5,0,"div",33,X),s()(),o(17,"div",12),S(18,Xe,1,3,"div",34,X),s(),o(20,"div",13)(21,"div",14),p("click",function(){return n.onClickDescription()}),o(22,"div",15),m(23,"i",16),o(24,"p"),l(25,"\u5099\u8A3B"),s()(),o(26,"span",17),l(27),s()(),T(28,Ze,4,0,"div",18),s(),T(29,et,2,1,"ng-template",null,19,ae)),a&2&&(d(5),F(5,n.expenseStatus===n.StatusEnum.Add?5:6),d(5),v("ngModel",n.price),d(3),oe("transform",n.translateFactor),d(2),D(n.tagsGroup),d(3),D(n.tagsGroup),d(9),y(" ",n.description," "),d(),F(28,n.expenseStatus===n.StatusEnum.Edit?28:-1))},dependencies:[W,Y,Q,de,q,U],styles:[".icon[_ngcontent-%COMP%]{width:40px;height:40px;background-color:#d1d5db;-webkit-mask-size:cover;mask-size:cover;display:inline-block}.active-icon[_ngcontent-%COMP%]{background-color:#111827}.transition[_ngcontent-%COMP%]{transform:all .8s ease-out}"]});let r=e;return r})();var Le=()=>A(w).getTagList(x.Expense).pipe(G(1),re(e=>e.reduce((t,a,n)=>{let c=Math.floor(n/9);return t[c]?t[c].push(a):t[c]=[a],t},[])));var Ve=()=>{let r=A(w),e=A(I),i=e?.getCurrentNavigation()?.extras.state?.expenseStatus;if(i===C.Edit){let t=e?.getCurrentNavigation()?.extras.state?.docId;return r.getExpenseInfo(t).then(a=>{if(a.exists()){let n=a.data();return{expenseStatus:i,docId:t,date:n.date,price:n.price,tagId:n.tagId,description:n.description}}else e.navigate(["/"])})}else if(i===C.Add){let t=e?.getCurrentNavigation()?.extras.state?.date;if(t)return{expenseStatus:i,date:le.fromDate(t)}}e.navigate(["/"])};var tt=["scrollTags"],it=["tagGroup"],nt=["templateRef"],rt=["priceInput"];function ot(r,e){if(r&1){let i=_();o(0,"button",20),p("click",function(){f(i);let a=g();return h(a.onClickSave())}),l(1," \u5132\u5B58 "),s()}}function at(r,e){if(r&1){let i=_();o(0,"button",20),p("click",function(){f(i);let a=g();return h(a.onClickEdit())}),l(1," \u5132\u5B58 "),s()}}var st=(r,e)=>e.id,ct=r=>({"bg-neutral-300":r});function lt(r,e){if(r&1){let i=_();o(0,"div",24),p("click",function(){let n=f(i).$implicit,c=g(2);return h(c.onTagClick(n.id))}),m(1,"i",25),o(2,"p"),l(3),s()()}if(r&2){let i=e.$implicit,t=g(2);v("ngClass",ee(3,ct,i.id===t.selectedTagId)),d(),v("ngClass",i.tagIconName),d(2),R(i.tagName)}}function dt(r,e){if(r&1&&(o(0,"div",21,22)(2,"div",23),S(3,lt,4,5,"div",26,st),s()()),r&2){let i=e.$implicit;d(3),D(i)}}var pt=r=>({"bg-gray-900":r});function mt(r,e){if(r&1&&m(0,"div",27),r&2){let i=e.$index,t=g(2);v("ngClass",ee(1,pt,t.currentTagGroupPage===i))}}function ut(r,e){if(r&1&&S(0,mt,1,3,"div",28,X),r&2){let i=g();D(i.tagsGroup)}}function gt(r,e){if(r&1){let i=_();o(0,"div",29),p("click",function(){f(i);let a=g();return h(a.onClickDelete())}),m(1,"i",30),o(2,"p",31),l(3,"\u522A\u9664"),s()()}}function ft(r,e){if(r&1){let i=_();o(0,"textarea",32),p("ngModelChange",function(a){f(i);let n=g();return h(n.description=a)}),s()}if(r&2){let i=g();v("ngModel",i.description)}}var je=(()=>{let e=class e{get StatusEnum(){return C}constructor(t,a,n,c,j){if(this.route=t,this.router=a,this.modalService=n,this.loaderService=c,this.ledgerService=j,this.maxTagGroupPage=0,this.currentTagGroupPage=0,this.translateFactor="translate(0, 0)",this.tagsGroup=[],this.selectedTagId="",this.description="",this.tagsGroup=this.route.snapshot.data.tagListGroup,this.incomeStatus=this.route.snapshot.data.data.incomeStatus,this.incomeStatus===C.Edit){let H=this.route.snapshot.data.data;this.price=parseInt(H.price),this.selectedTagId=H.tagId,this.description=H.description,this.date=H.date}else this.incomeStatus===C.Add&&(this.date=this.route.snapshot.data.data.date)}ngOnInit(){}ngAfterViewInit(){let t=this.scrollTagsRef.nativeElement.scrollWidth,a=this.tagGroupRef.nativeElement.scrollWidth;this.maxTagGroupPage=Math.ceil(t/a)}onSwipeRight(){if(this.currentTagGroupPage>0){this.currentTagGroupPage-=1;let t=this.currentTagGroupPage*100;this.translateFactor=`translate(-${t}%, 0)`}}onSwipeLeft(){if(this.currentTagGroupPage<this.maxTagGroupPage-1){this.currentTagGroupPage+=1;let t=this.currentTagGroupPage*100;this.translateFactor=`translate(-${t}%, 0)`}}onTagClick(t){this.selectedTagId===t?this.selectedTagId="":(this.priceInput.nativeElement.focus(),this.selectedTagId=t)}onClickBack(){this.router.navigateByUrl("/",{state:{transactionType:x.Income,date:this.date.toDate()}})}onClickSave(){return K(this,null,function*(){this.saveCheck()&&(this.loaderService.start(),yield this.ledgerService.addIncome({date:this.date,price:this.price.toString(),tagId:this.selectedTagId,description:this.description}).catch(t=>{console.error("Error adding document: ",t)}).then(()=>{this.router.navigateByUrl("/",{state:{transactionType:x.Income,date:this.date.toDate()}})}).finally(()=>this.loaderService.stop()))})}onClickEdit(){return K(this,null,function*(){this.saveCheck()&&(this.loaderService.start(),yield this.ledgerService.updateIncome({docId:this.route.snapshot.data.data.docId,date:this.date,price:this.price.toString(),tagId:this.selectedTagId,description:this.description}).catch(t=>{console.error("Error updating document: ",t)}).then(()=>{this.router.navigateByUrl("/",{state:{transactionType:x.Income,date:this.date.toDate()}})}).finally(()=>this.loaderService.stop()))})}saveCheck(){return!this.selectedTagId||!this.price?(this.modalService.openConfirm({content:"\u8ACB\u8F38\u5165\u91D1\u984D\u8207\u9078\u64C7\u6A19\u7C64",okText:"\u78BA\u8A8D",showCancelBtn:!1,outsideClose:!0}),!1):!0}onClickDescription(){this.modalService.openConfirm({title:"\u5099\u8A3B",okText:"\u78BA\u8A8D",showCancelBtn:!1,outsideClose:!0,contentTemplateRef:this.templateRef})}onClickDelete(){this.modalService.openConfirm({content:"\u78BA\u8A8D\u522A\u9664\uFF1F",outsideClose:!0,onOk:()=>{this.doDelete()}})}doDelete(){this.loaderService.start(),this.ledgerService.deleteIncome(this.route.snapshot.data.data.docId).then(()=>{this.router.navigateByUrl("/",{state:{transactionType:x.Income,date:this.date.toDate()}})}).finally(()=>this.loaderService.stop())}};e.\u0275fac=function(a){return new(a||e)(u(P),u(I),u(N),u($),u(w))},e.\u0275cmp=M({type:e,selectors:[["app-add-income"]],viewQuery:function(a,n){if(a&1&&(E(tt,5),E(it,5),E(nt,5),E(rt,5)),a&2){let c;k(c=b())&&(n.scrollTagsRef=c.first),k(c=b())&&(n.tagGroupRef=c.first),k(c=b())&&(n.templateRef=c.first),k(c=b())&&(n.priceInput=c.first)}},standalone:!0,features:[O],decls:30,vars:7,consts:[[1,"bg-gray-800","text-white","p-4","flex","justify-between","items-center"],[1,"w-10",3,"click"],[1,"fas","fa-arrow-left"],[1,"text-lg"],["class","bg-gray-600 px-4 py-2 rounded"],[1,"bg-green-600","text-center","p-10","flex"],[1,"text-white","text-3xl","me-3","pt-2"],["autocomplete","off","id","tagName","type","number","inputmode","numeric",1,"w-full","text-right","bg-green-600","rounded","border","border-green-700","focus:border-green-500","focus:ring-2","focus:ring-green-900","text-3xl","outline-none","text-gray-100","py-1","px-3","leading-8","transition-colors","duration-200","ease-in-out",3,"ngModel","ngModelChange"],["priceInput",""],[1,"w-full","overflow-hidden"],[1,"flex","w-full","transition",3,"swipeLeft","swipeRight"],["scrollTags",""],[1,"flex","justify-center","my-4"],[1,"bg-white","py-4","border-t","border-gray-300"],[1,"flex","p-4","border-b","items-center","justify-between",3,"click"],[1,"flex","items-center"],[1,"mr-4","fas","fa-pencil-alt"],[1,"w-3/5","text-ellipsis","overflow-hidden","text-right","text-nowrap"],["class","flex p-4 border-b justify-center items-center bg-green-600 text-white text-2xl"],["templateRef",""],[1,"bg-gray-600","px-4","py-2","rounded",3,"click"],[1,"w-screen","text-center"],["tagGroup",""],[1,"flex","w-screen","flex-wrap"],[1,"w-1/3","py-8",3,"ngClass","click"],[3,"ngClass"],["class","w-1/3 py-8",3,"ngClass"],[1,"mx-2","w-2","h-2","bg-gray-500","rounded-full",3,"ngClass"],["class","mx-2 w-2 h-2 bg-gray-500 rounded-full",3,"ngClass"],[1,"flex","p-4","border-b","justify-center","items-center","bg-green-600","text-white","text-2xl",3,"click"],[1,"fas","fa-trash","mr-2"],[1,""],["rows","10",1,"text-black","w-full",3,"ngModel","ngModelChange"],["class","w-screen text-center"]],template:function(a,n){a&1&&(o(0,"div",0)(1,"div",1),p("click",function(){return n.onClickBack()}),m(2,"i",2),s(),o(3,"h1",3),l(4,"\u65B0\u589E\u6536\u5165"),s(),T(5,ot,2,0,"button",4)(6,at,2,0),s(),o(7,"div",5)(8,"span",6),l(9,"$"),s(),o(10,"input",7,8),p("ngModelChange",function(j){return n.price=j}),s()(),o(12,"div",9)(13,"div",10,11),p("swipeLeft",function(){return n.onSwipeLeft()})("swipeRight",function(){return n.onSwipeRight()}),S(15,dt,5,0,"div",33,X),s()(),o(17,"div",12),T(18,ut,2,0),s(),o(19,"div",13)(20,"div",14),p("click",function(){return n.onClickDescription()}),o(21,"div",15),m(22,"i",16),o(23,"p"),l(24,"\u5099\u8A3B"),s()(),o(25,"span",17),l(26),s()(),T(27,gt,4,0,"div",18),s(),T(28,ft,1,1,"ng-template",null,19,ae)),a&2&&(d(5),F(5,n.incomeStatus===n.StatusEnum.Add?5:6),d(5),v("ngModel",n.price),d(3),oe("transform",n.translateFactor),d(2),D(n.tagsGroup),d(3),F(18,n.tagsGroup.length>1?18:-1),d(8),y(" ",n.description," "),d(),F(27,n.incomeStatus===n.StatusEnum.Edit?27:-1))},dependencies:[W,Y,Q,de,q,U],styles:["[_nghost-%COMP%]{display:block}"]});let r=e;return r})();var Fe=()=>A(w).getTagList(x.Income).pipe(G(1),re(e=>e.reduce((t,a,n)=>{let c=Math.floor(n/9);return t[c]?t[c].push(a):t[c]=[a],t},[])));var ve=function(r){return r.Add="add",r.Edit="edit",r}(ve||{});var Ge=()=>{let r=A(w),e=A(I),i=e?.getCurrentNavigation()?.extras.state?.incomeStatus;if(i===ve.Edit){let t=e?.getCurrentNavigation()?.extras.state?.docId;return r.getIncomeInfo(t).then(a=>{if(a.exists()){let n=a.data();return{incomeStatus:i,docId:t,date:n.date,price:n.price,tagId:n.tagId,description:n.description}}else e.navigate(["/"])})}else if(i===ve.Add){let t=e?.getCurrentNavigation()?.extras.state?.date;if(t)return{incomeStatus:i,date:le.fromDate(t)}}e.navigate(["/"])};var V=ke(Re());function _e(r){if(!r||typeof r!="string"||!/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/.test(r))return!1;let i=new Date(r),t=i.getFullYear().toString(),a=(i.getMonth()+1).toString().padStart(2,"0"),n=i.getDate().toString().padStart(2,"0");return r===`${t}-${a}-${n}`}var _t=(r,e)=>e.id;function xt(r,e){if(r&1){let i=_();o(0,"div",28),p("click",function(){let n=f(i).$implicit,c=g();return h(c.goToEditTag(n))}),o(1,"span"),m(2,"i",29),o(3,"span"),l(4),s()(),o(5,"span"),l(6),B(7,"number"),s()()}if(r&2){let i=e.$implicit;d(2),v("ngClass",i.tagInfo.tagIconName),d(2),R(i.tagInfo.tagName),d(2),y("$ ",L(7,3,i.price),"")}}function Ct(r,e){if(r&1&&(o(0,"div",30)(1,"div",4)(2,"div",31)(3,"div",32)(4,"span",33),l(5),B(6,"number"),s(),o(7,"span",34),l(8,"\u9031\u671F\u9918\u984D"),s()()(),o(9,"div",31)(10,"div",32)(11,"span",33),l(12),B(13,"number"),s(),o(14,"span",34),l(15,"\u6BCF\u65E5\u5269\u9918"),s()()(),o(16,"div",31)(17,"div",35)(18,"span",33),l(19),B(20,"number"),s(),o(21,"span",34),l(22,"\u5269\u9918\u9810\u7B97"),s()(),l(23," / "),o(24,"div",36)(25,"span",33),l(26),B(27,"number"),s(),o(28,"span",34),l(29,"\u9810\u7B97\u7E3D\u984D"),s()()()()()),r&2){let i=g();d(5),y("$ ",L(6,4,i.calculateRangeDayBudget()),""),d(7),y("$ ",L(13,6,i.calculateTodayBudget()),""),d(7),y("$ ",L(20,8,i.currentRangeBudget),""),d(7),y("$ ",L(27,10,i.budgetAmount),"")}}var J,xe=(J=class{get TransactionTypeEnum(){return x}constructor(e,i,t,a,n){this.router=e,this.loaderService=i,this.ledgerService=t,this.modalService=a,this.activatedRoute=n,this.transactionType=this.TransactionTypeEnum.Expense,this.currentDate=new Date,this.ledgerItems=[],this.showBudget=localStorage.getItem("showBudget")==="1",this.budgetAmount=parseInt(localStorage.getItem("budgetAmount")||"0"),this.currentRangeBudget=0,this.startDate="",this.endDate="";let c=this.activatedRoute.snapshot.queryParams.date;_e(c)&&(this.currentDate=(0,V.default)(c,"YYYY-MM-DD").toDate()),this.currentDate.setHours(0,0,0,0),this.getExpenseList()}ngOnInit(){this.countBudget()}countBudget(){let e=parseInt(localStorage.getItem("selectedDate")||"0");if(e){let i=(0,V.default)(this.currentDate),t,a;i.date()>=e?(t=i.date(e),a=i.add(1,"month").date(e).subtract(1,"day")):(t=i.subtract(1,"month").date(e),a=i.date(e).subtract(1,"day"));let n=t.format("YYYY/MM/DD"),c=a.format("YYYY/MM/DD");n!==this.startDate&&c!==this.endDate&&(this.startDate=n,this.endDate=c,this.ledgerService.getBudgetAmount(t.toDate(),a.toDate()).pipe(te(this)).subscribe(j=>{this.currentRangeBudget=this.budgetAmount-j}))}}calculateDiffRangeDay(){let e=(0,V.default)(this.currentDate);return(0,V.default)(this.endDate,"YYYY/MM/DD").diff(e,"day")+1}calculateRangeDayBudget(){let e=(0,V.default)(this.currentDate),t=(0,V.default)(this.endDate,"YYYY/MM/DD").diff(e,"day")+1;return parseInt((this.currentRangeBudget/t).toFixed())-this.totalAmount()}calculateTodayBudget(){let e=(0,V.default)(this.startDate,"YYYY/MM/DD"),t=(0,V.default)(this.endDate,"YYYY/MM/DD").diff(e,"day")+1;return parseInt((this.budgetAmount/t).toFixed())-this.totalAmount()}onSwipeLeft(){let e=structuredClone(this.currentDate);e.setDate(this.currentDate.getDate()+1),this.currentDate=e,this.onDateChange()}onSwipeRight(){let e=structuredClone(this.currentDate);e.setDate(this.currentDate.getDate()-1),this.currentDate=e,this.onDateChange()}onDateChange(){this.getExpenseList(),this.countBudget()}formateDate(e){return`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()}`}onClickAdd(){this.router.navigate(["/addExpense"],{state:{expenseStatus:C.Add,date:this.currentDate}})}getExpenseList(){this.loaderService.start(),this.ledgerService.getTodayExpenseList(this.currentDate).pipe(G(1),te(this)).subscribe(e=>{this.ledgerItems=e,this.loaderService.stop()})}totalAmount(){return this.ledgerItems.reduce((e,i)=>e+parseInt(i.price),0)}goToEditTag(e){let i={expenseStatus:C.Edit,docId:e.id,date:e.date,price:e.price,tagId:e.tagId,description:e.description};this.router.navigate(["/addExpense"],{state:i})}goToIncome(){this.router.navigate(["/incomeOverview"],{queryParams:{date:(0,V.default)(this.currentDate).format("YYYY-MM-DD")}})}onClickStatistics(){localStorage.getItem("showBudget")==="1"?this.router.navigate(["/setting/statisticsCharts"],{state:{date:this.currentDate}}):this.modalService.openConfirm({title:"\u901A\u77E5",content:"\u8ACB\u5148\u8A2D\u5B9A\u9810\u7B97\u9031\u671F\uFF0C\u518D\u67E5\u770B\u7D71\u8A08\u5716\u8868",okText:"\u78BA\u8A8D",outsideClose:!1,onOk:()=>{this.router.navigate(["/setting/budget"],{state:{date:this.currentDate}})}})}},J.\u0275fac=function(i){return new(i||J)(u(I),u($),u(w),u(N),u(P))},J.\u0275cmp=M({type:J,selectors:[["app-expense-overview"]],standalone:!0,features:[O],decls:44,vars:7,consts:[[1,"bg-gray-100","h-dvh","flex","flex-col"],[1,"flex","flex-col","flex-1"],[1,"sticky","top-0"],[1,"p-4","text-white","bg-red-600"],[1,"flex","justify-between","items-center"],[1,"w-1/5","text-2xl"],[1,"flex","items-center","justify-center","w-3/5",3,"click"],["src","https://img.icons8.com/ios-filled/50/ffffff/calendar.png","alt","Calendar",1,"h-6","w-6","me-2"],["matInput","","readonly","",1,"bg-red-600","text-2xl","w-36","mr-3","focus:outline-none",3,"ngModel","matDatepicker","ngModelChange","dateChange"],["touchUi",""],["picker",""],[1,"w-1/5","flex","justify-end"],[1,"p-2","rounded-full","bg-red-800",3,"click"],["src","https://img.icons8.com/ios-filled/50/ffffff/plus-math.png","alt","Add",1,"h-6","w-6"],[1,"p-4","text-white","bg-red-500"],[1,"flex","justify-between","items-center","text-4xl"],[1,"wrapper","flex-1","p-4","space-y-2","bg-red-500",3,"swipeLeft","swipeRight"],[1,"sticky","bottom-0"],["routerLink","/setting/budget","class","bg-red-300 p-4 text-red-800"],[1,"flex","justify-around","items-center","bg-gray-200"],[1,"w-1/4","p-4","pb-8","bg-gray-400"],[1,"fas","fa-arrow-up"],[1,"block","text-lg"],[1,"w-1/4","p-4","pb-8",3,"click"],[1,"fas","fa-arrow-down"],[1,"fas","fa-chart-line"],["routerLink","setting",1,"w-1/4","p-4","pb-8"],[1,"fas","fa-cog"],[1,"bg-white","p-2","flex","justify-between","items-center",3,"click"],[1,"w-5","mr-1",3,"ngClass"],["routerLink","/setting/budget",1,"bg-red-300","p-4","text-red-800"],[1,"flex"],[1,"mr-1","flex","flex-col","items-center"],[1,"text-xl","block"],[1,"text-sm"],[1,"mr-1","flex","flex-col","items-end"],[1,"ml-1","flex","flex-col","items-end"],["class","bg-white p-2 flex justify-between items-center"]],template:function(i,t){if(i&1){let a=_();o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),l(6),s(),o(7,"div",6),p("click",function(){f(a);let c=Z(11);return h(c.open())}),m(8,"img",7),o(9,"input",8),p("ngModelChange",function(c){return t.currentDate=c})("dateChange",function(){return t.onDateChange()}),s(),m(10,"mat-datepicker",9,10),s(),o(12,"div",11)(13,"button",12),p("click",function(){return t.onClickAdd()}),m(14,"img",13),s()()()(),o(15,"div",14)(16,"div",15)(17,"span"),l(18,"TWD"),s(),o(19,"span"),l(20),B(21,"number"),s()()()(),o(22,"div",16),p("swipeLeft",function(){return t.onSwipeLeft()})("swipeRight",function(){return t.onSwipeRight()}),S(23,xt,8,5,"div",37,_t),s()(),o(25,"div",17),T(26,Ct,30,12,"div",18),o(27,"div",19)(28,"button",20),m(29,"i",21),o(30,"span",22),l(31,"\u652F\u51FA"),s()(),o(32,"button",23),p("click",function(){return t.goToIncome()}),m(33,"i",24),o(34,"span",22),l(35,"\u6536\u5165"),s()(),o(36,"button",23),p("click",function(){return t.onClickStatistics()}),m(37,"i",25),o(38,"span",22),l(39,"\u7D71\u8A08"),s()(),o(40,"button",26),m(41,"i",27),o(42,"span",22),l(43,"\u8A2D\u5B9A"),s()()()()()}if(i&2){let a=Z(11);d(6),y(" ",t.calculateDiffRangeDay()||""," "),d(3),v("ngModel",t.currentDate)("matDatepicker",a),d(11),R(L(21,5,t.totalAmount())),d(3),D(t.ledgerItems),d(3),F(26,t.showBudget?26:-1)}},dependencies:[W,Y,Q,q,U,ce,se,fe,me,ue,ge],styles:["[_nghost-%COMP%]{display:block}.wrapper[_ngcontent-%COMP%]{overflow-y:auto;touch-action:pan-y!important}"]}),J);xe=ne([pe()],xe);var Ee=ke(Re());var wt=(r,e)=>e.id;function yt(r,e){if(r&1){let i=_();o(0,"div",27),p("click",function(){let n=f(i).$implicit,c=g();return h(c.goToEditTag(n))}),o(1,"span"),m(2,"i",28),o(3,"span"),l(4),s()(),o(5,"span"),l(6),B(7,"number"),s()()}if(r&2){let i=e.$implicit;d(2),v("ngClass",i.tagInfo.tagIconName),d(2),R(i.tagInfo.tagName),d(2),y("$ ",L(7,3,i.price),"")}}var z,Ce=(z=class{get TransactionTypeEnum(){return x}constructor(e,i,t,a,n){this.router=e,this.loaderService=i,this.ledgerService=t,this.modalService=a,this.activatedRoute=n,this.transactionType=this.TransactionTypeEnum.Income,this.currentDate=new Date,this.ledgerItems=[],this.showBudget=localStorage.getItem("showBudget")==="1",this.budgetAmount=parseInt(localStorage.getItem("budgetAmount")||"0"),this.currentRangeBudget=0,this.startDate="",this.endDate="";let c=this.activatedRoute.snapshot.queryParams.date;_e(c)&&(this.currentDate=(0,Ee.default)(c,"YYYY-MM-DD").toDate()),this.currentDate.setHours(0,0,0,0),this.getIncomeList()}ngOnInit(){}onSwipeLeft(){let e=structuredClone(this.currentDate);e.setDate(this.currentDate.getDate()+1),this.currentDate=e,this.onDateChange()}onSwipeRight(){let e=structuredClone(this.currentDate);e.setDate(this.currentDate.getDate()-1),this.currentDate=e,this.onDateChange()}onDateChange(){this.getIncomeList()}formateDate(e){return`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()}`}onClickAdd(){this.router.navigate(["/addIncome"],{state:{incomeStatus:C.Add,date:this.currentDate}})}getIncomeList(){this.loaderService.start(),this.ledgerService.getTodayIncomeList(this.currentDate).pipe(G(1),te(this)).subscribe(e=>{this.ledgerItems=e,this.loaderService.stop()})}totalAmount(){return this.ledgerItems.reduce((e,i)=>e+parseInt(i.price),0)}goToEditTag(e){let i={expenseStatus:C.Edit,docId:e.id,date:e.date,price:e.price,tagId:e.tagId,description:e.description};this.router.navigate(["/addExpense"],{state:i})}goToExpense(){this.router.navigate(["/expenseOverview"],{queryParams:{date:(0,Ee.default)(this.currentDate).format("YYYY-MM-DD")}})}onClickStatistics(){localStorage.getItem("showBudget")==="1"?this.router.navigate(["/setting/statisticsCharts"],{state:{date:this.currentDate}}):this.modalService.openConfirm({title:"\u901A\u77E5",content:"\u8ACB\u5148\u8A2D\u5B9A\u9810\u7B97\u9031\u671F\uFF0C\u518D\u67E5\u770B\u7D71\u8A08\u5716\u8868",okText:"\u78BA\u8A8D",outsideClose:!1,onOk:()=>{this.router.navigate(["/setting/budget"],{state:{date:this.currentDate}})}})}},z.\u0275fac=function(i){return new(i||z)(u(I),u($),u(w),u(N),u(P))},z.\u0275cmp=M({type:z,selectors:[["app-income-overview"]],standalone:!0,features:[O],decls:42,vars:5,consts:[[1,"bg-gray-100","h-dvh","flex","flex-col"],[1,"flex","flex-col","flex-1"],[1,"sticky","top-0"],[1,"p-4","text-white","bg-green-600"],[1,"flex","justify-between","items-center"],[1,"w-1/5","text-2xl"],[1,"flex","items-center","justify-center","w-3/5",3,"click"],["src","https://img.icons8.com/ios-filled/50/ffffff/calendar.png","alt","Calendar",1,"h-6","w-6","me-2"],["matInput","","readonly","",1,"bg-green-600","text-2xl","w-36","mr-3","focus:outline-none",3,"ngModel","matDatepicker","ngModelChange","dateChange"],["touchUi",""],["picker",""],[1,"w-1/5","flex","justify-end"],[1,"bg-green-800","p-2","rounded-full",3,"click"],["src","https://img.icons8.com/ios-filled/50/ffffff/plus-math.png","alt","Add",1,"h-6","w-6"],[1,"bg-green-500","p-4","text-white"],[1,"flex","justify-between","items-center","text-4xl"],[1,"bg-green-500","wrapper","flex-1","p-4","space-y-2",3,"swipeLeft","swipeRight"],[1,"sticky","bottom-0"],[1,"flex","justify-around","items-center","bg-gray-200"],[1,"w-1/4","p-4","pb-8",3,"click"],[1,"fas","fa-arrow-up"],[1,"block","text-lg"],[1,"w-1/4","p-4","pb-8","bg-gray-400"],[1,"fas","fa-arrow-down"],[1,"fas","fa-chart-line"],["routerLink","setting",1,"w-1/4","p-4","pb-8"],[1,"fas","fa-cog"],[1,"bg-white","p-2","flex","justify-between","items-center",3,"click"],[1,"w-5","mr-1",3,"ngClass"],["class","bg-white p-2 flex justify-between items-center"]],template:function(i,t){if(i&1){let a=_();o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),m(5,"div",5),o(6,"div",6),p("click",function(){f(a);let c=Z(10);return h(c.open())}),m(7,"img",7),o(8,"input",8),p("ngModelChange",function(c){return t.currentDate=c})("dateChange",function(){return t.onDateChange()}),s(),m(9,"mat-datepicker",9,10),s(),o(11,"div",11)(12,"button",12),p("click",function(){return t.onClickAdd()}),m(13,"img",13),s()()()(),o(14,"div",14)(15,"div",15)(16,"span"),l(17,"TWD"),s(),o(18,"span"),l(19),B(20,"number"),s()()()(),o(21,"div",16),p("swipeLeft",function(){return t.onSwipeLeft()})("swipeRight",function(){return t.onSwipeRight()}),S(22,yt,8,5,"div",29,wt),s()(),o(24,"div",17)(25,"div",18)(26,"button",19),p("click",function(){return t.goToExpense()}),m(27,"i",20),o(28,"span",21),l(29,"\u652F\u51FA"),s()(),o(30,"button",22),m(31,"i",23),o(32,"span",21),l(33,"\u6536\u5165"),s()(),o(34,"button",19),p("click",function(){return t.onClickStatistics()}),m(35,"i",24),o(36,"span",21),l(37,"\u7D71\u8A08"),s()(),o(38,"button",25),m(39,"i",26),o(40,"span",21),l(41,"\u8A2D\u5B9A"),s()()()()()}if(i&2){let a=Z(10);d(8),v("ngModel",t.currentDate)("matDatepicker",a),d(11),R(L(20,3,t.totalAmount())),d(3),D(t.ledgerItems)}},dependencies:[W,Y,Q,q,U,ce,se,fe,me,ue,ge],styles:["[_nghost-%COMP%]{display:block}.wrapper[_ngcontent-%COMP%]{overflow-y:auto;touch-action:pan-y!important}"]}),z);Ce=ne([pe()],Ce);var Bi=[{path:"",component:Oe,children:[{path:"",pathMatch:"full",redirectTo:"expenseOverview"},{path:"expenseOverview",component:xe},{path:"incomeOverview",component:Ce},{path:"addExpense",component:Be,resolve:{tagListGroup:Le,data:Ve}},{path:"addIncome",component:je,resolve:{tagListGroup:Fe,data:Ge}}]}];export{Bi as LEDGER_ROUTES};
